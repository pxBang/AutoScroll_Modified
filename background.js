chrome.runtime.onInstalled.addListener(t=>{chrome.storage.local.get("my_user_id",t=>{let e=t.my_user_id;e||(e=crypto.randomUUID(),chrome.storage.local.set({my_user_id:e}))})}),chrome.runtime.onInstalled.addListener(t=>{if(t.reason===chrome.runtime.OnInstalledReason.INSTALL){chrome.tabs.create({url:"https://autoscroll.click"});let e={mode:"continuous",speed:3,distance:2,interval:2,showFloatButton:!0};chrome.storage.sync.set({settings:e});let s=Date.now();chrome.storage.local.set({installTime:s})}else t.reason===chrome.runtime.OnInstalledReason.UPDATE||t.reason===chrome.runtime.OnInstalledReason.CHROME_UPDATE||(t.reason,chrome.runtime.OnInstalledReason.SHARED_MODULE_UPDATE)}),chrome.tabs.onActivated.addListener(t=>{chrome.tabs.get(t.tabId,t=>{chrome.storage.local.get("installTime",e=>{e.installTime&&t.id&&"complete"===t.status&&t.url&&!t.url.startsWith("chrome://")&&chrome.tabs.sendMessage(t.id,{action:"getStatus"},e=>{chrome.runtime.lastError&&chrome.storage.local.set({tabRequiresReload:{[t.id]:!0}})})})})}),chrome.storage.onChanged.addListener((t,e)=>{if("sync"===e&&t.settings){let s=t.settings.newValue,a=t.settings.oldValue||{};s&&a&&s.showFloatButton!==a.showFloatButton&&chrome.tabs.query({},t=>{t.forEach(t=>{t.url&&(t.url.startsWith("http://")||t.url.startsWith("https://"))&&chrome.tabs.sendMessage(t.id,{action:"updateFloatButton",showFloatButton:s.showFloatButton},()=>{chrome.runtime.lastError})})})}}),chrome.tabs.onRemoved.addListener(t=>{chrome.storage.local.get("tabRequiresReload",e=>{if(e.tabRequiresReload&&e.tabRequiresReload[t]){let s=e.tabRequiresReload;delete s[t],chrome.storage.local.set({tabRequiresReload:s})}})});const UNINSTALL_URL="https://autoscroll.click/uninstall/";chrome.runtime.setUninstallURL("https://autoscroll.click/uninstall/");